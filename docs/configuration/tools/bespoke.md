{% include_relative include/breadcrumbs.md %}

# Bespoke Tool

The Bespoke tool can be used to extend the functionality of your SMK application. Use it to tailor panel content to your needs.

As a simple example, you could add a list of links in HTML. As a more complex example, you could add JavaScript code that calls into other JavaScript global objects, letting you call other SMK tools or libraries used by SMK such as [Leaflet](https://leafletjs.com). Example code is in SMK's [debug/customization/bespoke](https://github.com/bcgov/smk/tree/master/debug/customization/bespoke) directory.

The content is typically generated by the application at runtime, and the application can use a mechanism ([Handlers](#handlers)) that allows SMK to notify the application when the panel is open and when it is closed.
The content that the application generates will be interpreted as a [Vue component](https://vuejs.org/v2/guide/components.html).

This is default configuration for the Bespoke tool (click on a property name for more information):
<pre>
{ "tools": [ {
    <a href="#type-property"     >"type"</a>:      "bespoke",
    <a href="#instance-property" >"instance"</a>:  null
    <a href="#title-property"    >"title"</a>:     null,
    <a href="#showtitle-property">"showTitle"</a>: false,
    <a href="#enabled-property"  >"enabled"</a>:   false,
    <a href="#icon-property"     >"icon"</a>:      <a href="https://material.io/tools/icons/?icon=help" target="material">"widgets"</a>,
    <a href="#order-property"    >"order"</a>:     1,
    <a href="#position-property" >"position"</a>:  "toolbar",
    <a href="#component-property">"component"</a>: null,
} ] }
</pre>

## Handlers

Unless you specify a static template for the [`"component"` property](#component-property), then you will need to use SMK handlers in your application to get notified when the panel is opened.
Then the application will be able to set the component property with the content that is needed at that moment.

Handlers can be configured after `smk.js` is loaded into the application, either before or after the map is initialized.
Multiple maps created in an application will share the same set of handlers.

To set a handler, make this method call:

    SMK.HANDLER.set( <<id>>, <<method>>, <<handler>> )

Where:

- `<<id>>` is the tool id as described in the [`"instance"` property](#instance-property).
- `<<method>>` is one of:
    - `"initialized"`: fired when the map is initialized
    - `"activated"`: fired when the tool is activated (button in toolbar is clicked, and tool wasn't active)
    - `"deactivated"`: fired when the tool is deactivated (close button clicked, or another tool activated)
    - `"triggered"`: fired when the tool button in toolbar is clicked
- `<<handler>>` is a function that will be called to handle the condition specified by the method. It's signature is:
```
    function ( smk, tool ) {
        // smk is the smkMap object
        // tool is the object being acted on.
        // Typically this handler will do something to change tool.component
        tool.component.template = "Hello!"
    }
```

{% include_relative include/type-property.md %}


## Instance Property
`"instance"`: `String`

This tool is allowed to have multiple instances in an application.
The instance property must be defined with an application-unique value for each use of the bespoke tool in the application configuration.

The [handlers](#handlers) defined for this tool will use the instance id as part of the id passed to the HANDLER methods, it is concantenated with the [`"type"` property](#type-property) seperated by `"--"`.

For example, if the instance is `"foo1"` then the id given to the HANDLER methods would be `"bespoke--foo1"`.


{% include_relative include/title-property.md %}
{% include_relative include/show-title-property.md %}
{% include_relative include/enabled-property.md %}
{% include_relative include/icon-property.md %}
{% include_relative include/order-property.md %}
{% include_relative include/position-property.md %}


## Component Property
`"component"`: `Object`

This property is assumed to be a [Vue component](https://vuejs.org/v2/guide/components.html) definition.

The simplest use is to specify a template:
```
{ "tools": [ { "type": "bespoke", "instance": "demo",
    "component": {
        "template": "<h1>Hello World!</h1>"
    }
} ] }
```

#### Note

Because of the way Vue components work, the template must have a single root element.

Things like this will not work: `"template": "<h1>Hello</h1><h2>World!</h2>"`;
so instead do this: `"template": "<div><h1>Hello</h1><h2>World!</h2></div>"`,
